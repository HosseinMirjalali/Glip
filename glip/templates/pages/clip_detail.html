{% extends "base.html" %}
{% load static %}
{% if clip %}
  {% block title %}{{ clip.title }}{% endblock %}
{% endif %}
<style>
</style>
{% block content %}
  {% if clip %}
    <br>
    <div class="embed-responsive embed-responsive-16by9 z-depth-1-half embedDetail">
      <iframe class="embed-responsive-item"
              src="{{ clip.embed_url }}&parent=glipsite.com&parent=www.glipsite.com"
              allowfullscreen="true" width="100%"></iframe>
    </div>
    {% comment %}    {% for comment in clip.comments.all %}
      <div data-toggle="commentModal" id="comment{{ comment.id }}" data-target="#videoModal"
           data-commentContent="{{ comment.content }}"
           data-commentUser="{{ comment.user }}" data-commentTimestamp="{{ comment.timestamp }}"
           data-commentUserAvatar="{{ comment.user.socialaccount_set.all.0.get_avatar_url }}">
      </div>
    {% endfor %}{% endcomment %}
    {% with comments.count as total_comments %}
      <br>
      <h3 class="text-white">{{ total_comments }} comment{{ total_comments|pluralize }}</h3>
    {% endwith %}

    {% if request.user.is_authenticated %}
      <br>
      <form id="myForm" method="post">
        {{ comment_form.as_p }}
        {% csrf_token %}
        <button type="submit"
                class="btn btn-outline-light btn-rounded ctaButton comment-submit d-flex justify-content-center align-items-center">
          Comment
        </button>
      </form>
    {% else %}
      <div class="mb-4">
        Please <a class="text-decoration-none" href="{% url 'account_login' %}">Login or Sign up</a> to make a comment
      </div>

    {% endif %}
    <hr><br>
    {% for comment in comments %}
      <div class="card mb-4">
        <div class="card-body">
          <p class="commentContent text-dark">{{ comment.content }}</p>

          <div class="d-flex justify-content-between">
            <div class="d-flex flex-row align-items-center">
              <img
                      class="commentUserAvatar"
                      src="{{ comment.user.socialaccount_set.all.0.get_avatar_url }}"
                      alt="avatar"
                      width="25"
                      height="25"
              />
              <p class="small mb-0 ms-2 commentUser text-dark">{{ comment.user }}</p>
            </div>
            <div class="d-flex flex-row align-items-center">
              <p class="commentTimestamp small text-muted mb-0">{{ comment.timestamp }}</p>
            </div>
          </div>
        </div>
      </div>
    {% empty %}
      No comments yet...
    {% endfor %}

  {% else %}
    <style>
      .masthead {
        height: 100vh;
        min-height: 500px;
        background-size: cover;
        background-position: center;
        background-repeat: no-repeat;
      }

      a {
        color: #6A5ACD;
      }

      hr {
        color: #6A5ACD;
      }
    </style>
    <div class="masthead justify-content-center text-center">
      <br><br><br><br><br><br><br>
      <strong>Clip not found :(</strong>
      <br>
      <strong>Please try again...</strong>
      <br>
      <hr>
      <br><br><br><br><br><br>
    </div>
  {% endif %}
{% endblock %}
